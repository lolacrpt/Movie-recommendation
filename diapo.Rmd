---
title: "SystÃ¨me interactif de recommandation de films"
subtitle: "Application interactive avec Shiny"
author: "Carpentier Lola, De Oliveira Corentin, Reynaud Valentin"
date: "2025-01-10"
output: 
    ioslides_presentation: 
        widescreen: true
        smaller: true
        css: custom.css
        
        
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


## ğŸ¬ SystÃ¨me interactif de recommandation de films


Objectifs du projet : dÃ©velopper un systÃ¨me interactif de recommandation de films. L'application permet :

- De choisir une Ã©motion Ã  ressentir.

- Dâ€™indiquer le temps disponible pour regarder un film.

- De recevoir des recommandations personnalisÃ©es.

- De sÃ©lectionner un film et de visualiser sa bande-annonce directement dans le navigateur.



- ğŸ“¦ Installer les packages nÃ©cessaires

Pour construire cette application, nous avons utilisÃ© :


- **Shiny** : pour crÃ©er une interface web interactive.

- **Readr** : pour manipuler les donnÃ©es.



## ğŸ“ Charger les donnÃ©es

Les donnÃ©es utilisÃ©es contiennent des informations sur les films, comme :

- Titre
- Genre
- DurÃ©e
- Ã‰motion associÃ©e
- Lien vers la bande-annonce

Elles proviennent de sources comme **Kaggle** et des recherches complÃ©mentaires.

```{r donnees, eval=FALSE, echo=TRUE, message=FALSE, warning=FALSE}
movies <- read_csv("pelletier_emotions.csv")
```

- Normalisation

```{r normalisation,eval=FALSE, echo=TRUE, message=FALSE, warning=FALSE}
movies$emotion_tags <- trimws(tolower(movies$emotion_tags))

```

Cela permet dâ€™Ã©viter les erreurs lors du filtrage des donnÃ©es.

## ğŸ–¥ï¸ Interface Utilisateur (UI)

L'interface utilisateur est composÃ©e de deux parties:

1.Panneau latÃ©ral

L'utilisateur peut:

- SÃ©lectionner une Ã©motion.
- Indiquer la durÃ©e souhaitÃ©e du film.
- Choisir le nombre de recommandations Ã  afficher

```{r,eval=FALSE, echo=TRUE, message=FALSE, warning=FALSE}
cat("- <span style='font-size: 12px;'>Texte rÃ©duit</span>\n")
ui <- fluidPage(
  titlePanel("ğŸ¬ SystÃ¨me de Recommandation de Films"),
  sidebarLayout(
    sidebarPanel(
      h4("ğŸŒˆ SÃ©lectionnez vos prÃ©fÃ©rences :"),
      selectInput("emotion", "ğŸ­ Choisissez une Ã©motion :", 
                  choices = unique(movies$emotion_tags)),
      radioButtons("duration", "â³ Combien de temps avez-vous ?", 
                   choices = c("Moins de 2h" = "short", "Plus de 2h" = "long")),
      numericInput("num_recommendations", "ğŸ”¢ Nombre de recommandations :", value = 3, min = 1),
      actionButton("recommend", "Obtenir des recommandations ğŸ¬"),
```
## ğŸ–¥ï¸ Interface Utilisateur (UI)
2.Panneau principal 
 
 -Il affiche les recommandations dans une table.

    -   Une zone pour valider ou rejeter les recommandations apparaÃ®t dynamiquement.

    -   AprÃ¨s validation, des cases Ã  cocher permettent de choisir un ou plusieurs films.

    -   Enfin, un bouton ouvre les bande-annonces des films sÃ©lectionnÃ©s.
```{r panneau principal,eval=FALSE, echo=TRUE, message=FALSE, warning=FALSE}
  uiOutput("feedback_ui")  # Section pour valider ou rejeter les recommandations
    ),
    mainPanel(
      h3("ğŸ“‹ Recommandations :"),
      tableOutput("recommendations"),  # Affiche les recommandations
      uiOutput("choose_movie_ui"),  # Cases Ã  cocher pour choisir un film
      actionButton("open_trailer", "Ouvrir la bande-annonce ğŸ¥"),  # Bouton pour ouvrir la bande-annonce
      textOutput("final_choice")  # Confirmation du choix
    )
  )
)
```


##  ğŸ§  Partie Serveur

La partie serveur applique les filtres et gÃ¨re les interactions de l'utilisateur.

```{r serveur, eval=FALSE, echo=TRUE, message=FALSE, warning=FALSE}
server <- function(input, output, session) {
```
 Nous allons vous expliquer les fonctionnalitÃ©s principales. 

1. **GÃ©nÃ©ration des recommandations** Lorsque lâ€™utilisateur clique sur le bouton "Obtenir des recommandations", le programme applique des filtres: 


## Filtrage 
- ğŸ­  Filtrage par Ã©motion
Il sÃ©lectionne les films qui correspondent Ã  lâ€™Ã©motion choisie: 

```{r filtrage Ã©motions, eval=FALSE, echo=TRUE, message=FALSE, warning=FALSE}
   observeEvent(input$recommend, {
    filtered <- movies[movies$emotion_tags == input$emotion, ]
```


- â³Filtrage par durÃ©e
Ensuite, il restreint les rÃ©sultats selon la durÃ©e sÃ©lectionnÃ©e :
```{r filtrage durÃ©e, eval=FALSE, echo=TRUE, message=FALSE, warning=FALSE}
 if (input$duration == "short") {
      filtered <- filtered[filtered$duration <= 120, ]
    } else if (input$duration == "long") {
      filtered <- filtered[filtered$duration > 120, ]
    }

```

## Filtrage 
- ğŸ“Š Nombre de recommandations
Enfin, il limite le nombre de films affichÃ©s en sÃ©lectionnant un Ã©chantillon alÃ©atoire Les recommandations sont ensuite stockÃ©es dans une variable rÃ©active. 

```{r filtrage nombre, eval=FALSE, echo=TRUE, message=FALSE, warning=FALSE}
 if (nrow(filtered) > 0) {
      filtered <- filtered[sample(nrow(filtered), min(input$num_recommendations, nrow(filtered))), ]
    }
    
```
Les recommandations sont ensuite stockÃ©es dans une variable rÃ©active: 
```{r stockage, eval=FALSE, echo=TRUE, message=FALSE, warning=FALSE}
recommendations <- reactiveVal(filtered)

```

## 2.  ğŸ“‹Affichage des recommandations 
Les recommandations sont affichÃ©es sous forme de table dynamique dans l'interface principale. Cette table montre les titres des films, leur genre, leur durÃ©e, et un lien vers la bande-annonce.
```{r affichage, eval=FALSE, echo=TRUE, message=FALSE, warning=FALSE}

 output$recommendations <- renderTable({
    req(recommendations())
    recs <- recommendations()
    if (nrow(recs) > 0) {
      recs[, c("title", "genre", "duration", "BA")]  # Colonnes affichÃ©es
    } else {
      NULL
    }
  }, rownames = TRUE)

```

##  3.  âœ…Validation ou rejet des recommandations 
Une fois que les recommandations sont affichÃ©es, lâ€™utilisateur doit indiquer sâ€™il est satisfait ou non grÃ¢ce Ã  deux boutons ("Oui" ou "Non").
```{r validation, eval=FALSE, echo=TRUE, message=FALSE, warning=FALSE }
 output$feedback_ui <- renderUI({
    if (nrow(recommendations()) > 0) {
      tagList(
        h4("ğŸ” Ces recommandations vous conviennent-elles ?"),
        actionButton("yes", "Oui, elles sont parfaites"),
        actionButton("no", "Non, je veux en voir d'autres")
      )
    }
  })
```
Si lâ€™utilisateur clique sur "Non", les recommandations sont rÃ©initialisÃ©es, et le processus recommence.
```{r rÃ©initialisation,  eval=FALSE, echo=TRUE, message=FALSE, warning=FALSE}
observeEvent(input$no, {
    showNotification("ğŸ”„ Nouvelles recommandations en cours...", type = "message")
    recommendations(data.frame())  # RÃ©initialiser les recommandations
  })
```
## 4.  ğŸ¥  SÃ©lection des films prÃ©fÃ©rÃ©s
Si les recommandations conviennent, une liste de cases Ã  cocher apparaÃ®t pour permettre Ã  lâ€™utilisateur de sÃ©lectionner un ou plusieurs films parmi les options proposÃ©es:
```{r prÃ©fÃ©rences, eval=FALSE, echo=TRUE, message=FALSE, warning=FALSE}
  output$choose_movie_ui <- renderUI({
    req(input$yes)  # Attendre la validation des recommandations
    recs <- recommendations()
    if (nrow(recs) > 0) {
      checkboxGroupInput("chosen_movies", "ğŸ¥ Cochez le ou les films qui vous intÃ©ressent :", 
                         choices = recs$title)
    }
  })
  

```


## 5. ğŸ¬ Ouverture des bande-annonces
Lorsque lâ€™utilisateur clique sur "Ouvrir la bande-annonce ğŸ¥", les liens vers les bande-annonces des films sÃ©lectionnÃ©s sont ouverts dans le navigateur:
```{r bande annonces, eval=FALSE, echo=TRUE, message=FALSE, warning=FALSE}
  observeEvent(input$open_trailer, {
    req(input$chosen_movies)  # S'assurer qu'au moins un film a Ã©tÃ© cochÃ©
    recs <- recommendations()
    chosen <- recs[recs$title %in% input$chosen_movies, ]  # Trouver les films cochÃ©s
    if (nrow(chosen) > 0) {
      lapply(chosen$BA, browseURL)  # Ouvrir les bande-annonces dans le navigateur
      output$final_choice <- renderText({
        paste("Vous avez choisi de regarder :", paste(chosen$title, collapse = ", "), "- Bon visionnage ! ğŸ¬")
      })
    }
  })
}


```
## Conclusion
- Points positifs 


- Limites 

## DÃ©monstration 
```{r,  eval=FALSE, echo=TRUE, message=FALSE, warning=FALSE}
shinyApp(ui, server)
```